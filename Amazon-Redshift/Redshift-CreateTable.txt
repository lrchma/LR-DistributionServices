--requires tuning for appropriate datatypes
create external table logrhythm.logrhythm(
account                 varchar,
action                  varchar,
aggregate               varchar,
amount                  varchar,
archive                 varchar,
bytesin                 varchar,
bytesout                varchar,
collectionsequence      varchar,
command                 varchar,
commoneventid           bigint,
cve                     varchar,
dateinserted            varchar,
dhostid                 bigint,
dhostzone               bigint,
dinterface              varchar,
dip                     varchar,
direction               bigint,
dlocationkey            varchar,
dmac                    varchar,
dname                   varchar,
dnameparsed             varchar,
dnameresolved           varchar,
dnatip                  varchar,
dnatport                bigint,
dnetworkid              bigint,
domain                  varchar,
domainorigin            varchar,
dport                   bigint,
droplog                 varchar,
dropraw                 varchar,
duration                varchar,
entityid                bigint,
eventclassification     bigint,
eventcommoneventid      bigint,
falsealarmrating        bigint,
forward                 varchar,
forwardtologmart        varchar,
glprassignedrbp         bigint,
groupname                  varchar,
hasbeeninserted_emdb    varchar,
hasbeenqueued_archiving varchar,
hasbeenqueued_eventprocessor    varchar,
hasbeenqueued_logprocessor      varchar,
hash                    varchar,
hostid                  bigint,
ignoreglobalrbpcriteria varchar,
isdnameparsedvalue      varchar,
isremote                varchar,
issnameparsedvalue      varchar,
itemsin                 varchar,
itemsout                varchar,
login                   varchar,
logmartmode             bigint,
mediatormsgid           bigint,
mediatorsessionid       bigint,
mperuleid               bigint,
msgclassid              bigint,
msgcount                bigint,
msgdate                 timestamp,
msgdateorigin           bigint,
msgsourcehostid         bigint,
msgsourceid             bigint,
normalmsgdate           timestamp,
object                  varchar,
objectname              varchar,
objecttype              varchar,
parentprocessid         varchar,
parentprocessname       varchar,
parentprocesspath       varchar,
pid                     bigint,
policy                  varchar,
priority                bigint,
process                 varchar,
protocolid              bigint,
quantity                varchar,
rate                    varchar,
reason                  varchar,
recipient               varchar,
recipientidentity       varchar,
recipientidentitycompany        varchar,
recipientidentitydepartment     varchar,
recipientidentitydomain varchar,
recipientidentityid     bigint,
recipientidentitytitle  varchar,
responsecode            varchar,
result                  varchar,
riskrating              bigint,
sender                  varchar,
senderidentity          varchar,
senderidentitycompany   varchar,
senderidentitydepartment        varchar,
senderidentitydomain    varchar,
senderidentityid        bigint,
senderidentitytitle     varchar,
serialnumber            varchar,
serviceid              bigint,
session                 varchar,
sessiontype             varchar,
severity                varchar,
shostid                 bigint,
shostzone               bigint,
sinterface              varchar,
sip                     varchar,
size                    varchar,
slocationkey            varchar,
smac                    varchar,
sname                   varchar,
snameparsed             varchar,
snameresolved           varchar,
snatip                  varchar,
snatport                bigint,
snetworkid              bigint,
sport                   bigint,
status                  varchar,
subject                 varchar,
systemmonitorid         bigint,
threatid                varchar,
threatname              varchar,
uniqueid                varchar,
url                     varchar,
useragent               varchar,
userimpactedidentity    varchar,
userimpactedidentitycompany     varchar,
userimpactedidentitydomain      varchar,
userimpactedidentityid  bigint,
userimpactedidentitytitle       varchar,
useroriginidentity      varchar,
useroriginidentitycompany       varchar,
useroriginidentitydepartment    varchar,
useroriginidentitydomain        varchar,
useroriginidentityid    bigint,
useroriginidentitytitle varchar,
vendorinfo              varchar,
vendormsgid             bigint,
version                 varchar
)
row format delimited
fields terminated by ','
stored as textfile
location 's3://bucketname/folder/'
table properties ('numRows'='172000');